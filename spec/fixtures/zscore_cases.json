{
  "description": "Test cases for z-score trigger",
  "spec_section": "§2.1",
  "formula": "Z_t = (value - μ) / σ, trigger if |Z| > threshold",
  "params": {"window": 5, "threshold": 2.0, "min_periods": 3},
  "cases": [
    {
      "name": "positive_trigger",
      "input": {
        "value": 10.0,
        "history": [1.0, 2.0, 1.5, 1.8, 2.2]
      },
      "expected": {
        "zscore": 17.89,
        "triggered": true,
        "direction": 1
      },
      "tolerance": 0.01,
      "note": "μ=1.7, σ=0.45, Z=(10-1.7)/0.45=18.4"
    },
    {
      "name": "negative_trigger",
      "input": {
        "value": -5.0,
        "history": [1.0, 2.0, 1.5, 1.8, 2.2]
      },
      "expected": {
        "zscore": -14.89,
        "triggered": true,
        "direction": -1
      },
      "tolerance": 0.01
    },
    {
      "name": "no_trigger_within_band",
      "input": {
        "value": 2.0,
        "history": [1.0, 2.0, 1.5, 1.8, 2.2]
      },
      "expected": {
        "zscore": 0.67,
        "triggered": false,
        "direction": 0
      },
      "tolerance": 0.01,
      "note": "Z=0.67 < 2.0 threshold"
    },
    {
      "name": "exactly_at_threshold",
      "input": {
        "value": 2.6,
        "history": [1.0, 1.0, 1.0, 1.0, 1.0]
      },
      "expected": {
        "zscore": null,
        "triggered": false,
        "direction": 0
      },
      "note": "σ=0 when all same, handle gracefully"
    },
    {
      "name": "insufficient_history",
      "input": {
        "value": 5.0,
        "history": [1.0, 2.0]
      },
      "expected": {
        "zscore": null,
        "triggered": false,
        "direction": 0
      },
      "note": "Less than min_periods=3"
    },
    {
      "name": "zero_std",
      "input": {
        "value": 5.0,
        "history": [2.0, 2.0, 2.0, 2.0, 2.0]
      },
      "expected": {
        "zscore": null,
        "triggered": false,
        "direction": 0
      },
      "note": "σ=0, cannot compute z-score"
    }
  ]
}
